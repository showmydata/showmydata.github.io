---
layout: post
title: "2022春-计网-第8讲"
categories: 
  - Courses
tags:
  - 课程学习
  - 计算机网络
last_modified_at: 2022-03-18T22:10:52+08:00u
---

## 随机访问MAC协议

**时隙ALOHA协议**

- 假定：
  - 所有帧大小相同
  - 时间被划分为等长的时隙（每个时隙可以传一个帧）
  - 结点只能在时隙开始时刻发送帧
  - 结点间时钟同步
  - 如果2个或2个以上结点在同一时隙发送帧，结点即检测到冲突
- 运行：
  - 当结点有新的帧时，在下一个时隙发送
    - 无冲突：该节点可以在下一个时隙继续发送新的帧
    - 有冲突：该节点在下一个时隙以概率p重传该帧，直至成功

- 优点
  - 单个结点活动时，可以连续以信道全部速率传输数据
  - 高度分散化：只需同步时隙
  - 简单
- 缺点：
  - 冲突，浪费时隙
  - 空闲时隙
  - 结点也许能以远小于分组传输的时间检测到冲突
  - 时钟同步
- 效率：长期运行时，成功发送帧的时隙所占比例
  - 假设：N个结点，每个结点在每个时隙均以概率p发送数据
  - 对于任意结点成功发送帧的概率$Np(1-p)^{N-1}$
  - 最大效率，当N趋近无穷时的极限，最大效率$1/e=0.37$

**ALOHA协议**

- 非时隙（纯）Aloha：更加简单，无需同步
- 当有新的帧生成时，立即发送
- 冲突可能性增大
- 效率$P=p\cdot (1-p)^{N-1}\cdot (1-p)^{N-1}=p\cdot (1-p)^{2(N-1)}$
- 最大效率$1/(2e) = 0.18$

**CSMA协议**

- 载波监听多路访问协议（carrier sense multiple access）
- 发送帧之前，监听信道（载波）：
  - 信道空闲：发送完整帧
  - 信道忙：推迟发送
    - 1-坚持CSMA
    - 非坚持CSMA
    - P-坚持CSMA
- 冲突可能仍然发生：信号传播延迟

**CSMA/CD 协议**

- CSMA/CD：CSMA with Collision Dection
  - 短时间内可以检测到冲突
  - 冲突后传输中止，减少信道浪费
  - 边发边听，不发不听
- 冲突检测
  - 有线局域网易于实现：测量信号强度，比较发射信号与接收信号
  - 无线局域网很难实现
- 限制
  - 网络带宽R bps，数据帧最小长度$L_{min}$bps，信号传播速度V m/s
  - $L/R \ge 2d_{max}/V$
  - $L_{min}/R = 2d_{max}/V = RTT_{max}$
- 效率
  - $T_{prop}=LAN中2个结点间的最大传播延迟$
  - $t_{trans} = 最长帧传输延迟$
  - $效率 = \frac{1}{1+5t_{prop}/t_{trans}}$
  - 当$t_{prop}$趋近于0或者$t_{trans}$趋近于无穷时，效率趋近于1
  - 远优于ALOHA，并且简单、分散

**轮转访问MAC协议**

- 轮循：
  - 主节点轮流“邀请”从属结点发送数据
  - 轮询开销、等待延迟、单点故障
- 令牌传递：
  - 控制令牌依次从一个结点传递到下一个结点
  - 令牌：特殊帧
  - 令牌开销、等待延迟、单点故障
- 比特映像介质访问控制协议
  - 将时间划分为一些列的预约周期和数据传输周期
  - 每个预约周期包括N个时隙，每个时隙1比特，对应1个站
  - 任何一个站想发送数据，必须在它的时隙到来时发送一个“1”
  - 当预约周期结束后，所有站都知道有哪些站希望发送数据，于实这些预约过的站按序好顺序发送，永不冲突
  - 最后一个站发完数据后，开启新一轮的预约周期

---

##局域网技术

**链路层寻址：MAC地址**

- 链路层寻址关键需求：唯一
- MAC地址（或称LAN地址，物理地址，以太网地址）：
  - 作用：用于局域网内标识一个帧从哪个接口发出，到达哪个物理相连的其它接口
  - 48位MAC地址（用于大部分LANs），固化在网卡的ROM中，有时也可以软件设置
- IP地址
  - 32位（IPv4）
  - 接口的网络层地址
  - 用于标识网络层（第3层）分组

> MAC地址：身份证号，可“携带”
>
> IP地址：邮政地址，不可“携带”

**以太网**

- “统治地位”的有限LAN技术
- 造价低廉
- 应用最广泛的LAN技术
- 比令牌局域网和ATM等简单、便宜
- 满足网络速率需求：10Mbps-10Gbps

- 物理拓扑
  - 总线：所有结点在统一冲突域，已被淘汰
  - 星型：中心交换机
- 不可靠：接收网卡不想发送网卡进行确认
- 无连接：发送帧的网卡与接收帧的网卡间没有“握手”过程
  - 差错帧直接丢弃，丢弃帧中的数据恢复依靠高层协议
- 以太网的MAC协议：采用二进制指数退避算法的CSMA/CD
  1. NIC从网络层接收数据报，创建数据帧
  2. 监听信道：空闲则发送，信道忙则等待
  3. NIC发送王整个帧，而没有检测到其它结点的数据发送，则NIC确认帧发送成功
  4. 如果NIC检测到其它结点传输数据，则中止发送，并发送杜策信号
  5. 中止发送后，NIC进入二进制指数退避
     - 第m次连续冲突后：
       - 取n=Min(m, 10)
       - NIC从$\{0,1,2,...,2^n-1\}$中随机选择一个数K
       - NIC等待$K\cdot 512$比特的传输延迟时间，再返回第2步
     - 连续冲突次数越多，平均等待时间越长
- 以太网帧结构
  - 单位：字节
  - 前导码8，目的地址6，源地址6，类型2，数据46~1500，校验和4
  - 前导码8，目的地址6，源地址6，长度2，数据46~1500，校验和4
  - 前导码
    - 7个字节的10101010，第8字节位10101011
    - 用于发送端与接收端的时钟同步
    - 通常不计入帧长
  - 目的MAC地址、源MAC地址：48位，6B
  - 类型（Type）：2B，指示帧中是那种高层协议的分组
  - 数据：指上层协议载荷
    - 根据CSMA/CD要求，为保证碰撞检测以太网最小帧长为64字节
    - $R=10Mbps,RTT_{max}=51.2\micro s,L_{min}/R=RTT_{max}$
    - $L_{min}=512bits=64B,Data_{min}=L_{min}=18=46B$
  - CRC（4B）：循环冗余校验码
    - 丢弃差错帧
