---
layout: post
title: "2022春-计网-第3讲"
categories: 
  - Courses
tags:
  - 课程学习
  - 计算机网络
last_modified_at: 2022-03-02T22:10:52+08:00u
---

## 计算机网络结构

**计算机网络体系结构**：简称网络体系结构，network architecture

- 分层结构
- 每层完成一种/类特定服务/功能，
- 每层遵循某个/些网络协议来完成本层功能
- 计算机网络体系结构是网络各层及其协议的集合
- 体系结构是抽象的，是一个计算机网络的功能层次及其关系的定义

> 为什么是分层模型？
>
> - 结构清晰，有利于识别复杂系统的部件及其关系
> - 模块化的分层易于系统更新、维护
> - 有利于标准化 

**分层网络体系结构**：

- 实体（entity）表示任何可发送或接收信息的硬件或软件进程
- 协议（protocol）是控制**两个对等实体**进行通信的规则的集合，同层“水平的”
- 服务（service），任一层实体需要使用下层服务，遵循本层协议，实现本层功能，向上层提供服务，服务是“垂直的”
- 下层协议的实现对上层的服务用户是**透明**的
- 同系统的相邻层实体间通过**接口**进行交互，通过服务访问点**SAP（Service Access Point）**，交换**原语**，指定请求的特定服务。

> 一些tips关于“下层协议的实现对上层是透明的”
>
> - 上层只能看到下层的服务，而不会看见下层协议的具体实现
> - 计算机科学中的“透明”，指的是客观存在并且运行着但是我们看不到的特性

**OSI参考模型**：开发系统互连参考模型，ISO于1984年提出，分层模型

- 目的是支持**异构**网络系统的互联互通
- 异构系统互连的国际标准
- 理论成功，市场失败，用于理解网络通信过程
- 7层（功能），每层完成特定的网络功能
- 自顶向下：应用层（Application）、表示层（Presentation）、会话层（Session）、传输层（Transport）、网络层（Network）、数据链路层（Data link）、物理层（Physical）

- 中间系统（往往是路由器）存在三层，分别是网络层、数据链路层、物理层，这三层也组成互联网络，上四层则又称为端-端层（End-End)

> 上层发送到下层-封装，加文件头/数据封装的意义何在？
>
> - 数据链路层到物理层不加文件头，只是转换为了比特流
> - 增加控制信息，构造协议数据单元PDU
> - 控制信息包括
>   - 地址（Address）：标识发送端/接收端
>   - 差错检测编码（Error-detecting code）：用于差错检测或纠正
>   - 协议控制：实现协议功能的附加信息，如优先级、服务质量QoS、安全控制等

**物理层功能**：

- 接口特性：
  - 机械特性：引脚数量、接口形状等
  - 电气特性：引脚的电压范围、阻抗匹配等
  - 功能特性：描述电平的意义、接口部件和信号线用途等
  - 规程特性：又称过程特性，规定各个物理线路工作规程，时序关系
- 比特编码
- 数据率
- 比特同步 - 时钟同步
- 传输模式
  - 单工（Simplex）、半双工（half-duplex）、全双工（full-duplex）

**数据链路层功能**：

- 负责结点-结点（node-to-node）数据传输
- 组帧（Framing）
- 物理寻址（Physical addressing）
  - 在帧头中增加发送端和/或接收端的物理地址标识数据帧的发送端和/或接收端
- 流量控制（Flow control）
- 差错控制（Error control），检测并重传损坏或丢失帧，并避免重复帧
- 访问控制（Access control），在任一给定时刻决定那个设备拥有链路（物理介质）控制使用权

**网络层功能**：

- 负责源主机到目的主机数据分组传输
- 逻辑寻址（Logical addressing），全局唯一逻辑地址，IP地址，确保数据分组被送达目的主机
- 路由（Routing）
- 转发（Forwarding）

**传输层功能**：

- 分段与重组
- SAP（服务访问结点）寻址
  - 确保将完整报文提交给正确进程，如端口号
- 连接控制
- 流量控制
- 差错控制

> OSI参考模型中自下到上，第一个提供端到端的层次是：
>
> - 传输层

> MAC地址、IP地址、端口号的区别
>
> - **IP地址：**（基于计算机或路由器）在网络层的IP头部里，用于识别网络中互联的主机和路由器，其实主要是确认子网，通过子网掩码确认某个IP地址所在的子网，而后再在子网内部确认mac地址就能找到准确的用户了。
> - **MAC地址：**（基于网卡或路由器）在数据链路层包裹在以太网头部中的，它主要用来识别同一个链路中的不同计算机。Mac地址即网卡号，每块网卡出厂的时候，都有一个全世界独一无二的 MAC 地址，长度是 48 个二进制位，通常用 12 个十六进制数表示。
> - **端口号：**在传输层包含在TCP/UDP头部中的，用于识别应用程序。一台主机上能运行多个程序，那么接收到的消息到底是哪个程序的呢？就需要端口号来确认
> - 端口是应用层的概念，端口号由传输层西医决定

**会话层功能**：

- 对话控制（dialog controlling）
- 同步
  - 在数据流中插入“同步点”，类似于checkpoint
- 最“薄“的一层

**表示层功能**：

- 处理两个系统间交换信息的**语法和语义**（syntax and semantics）
- 数据表示转化
  - 转换为主机独立的编码
- 加密/解密
- 压缩/解压缩

**应用层功能**：

- 支持用户通过用户代理（如浏览器）或网络接口使用网络（服务）
- 典型应用层服务：
  - 文件传输（FTP）
  - 电子邮件（SMTP）
  - Web（HTTP）

**TCP/IP模型**：

- 应用层：HTTP、SMTP，DNS、RTP
- 传输层：TCP、UDP
- 网际层：IP
- 网络接口层

<div class="mermaid">
graph TD
A1(HTTP);
A2(SMTP);
A3(DNS);
A4(RTP);
B1(TCP);
B2(UDP);
C1(IP);
D1(网络接口1);
D2(网络接口2);
D3(网络接口3);
A1--->B1;
A2--->B1;
A3--->B2;
A4--->B2;
B1--->C1;
B2--->C1;
C1--->D1;
C1--->D2;
C1--->D3;
</div>






**5层参考模型**：综合OSI和TCP/IP的优点

- 应用层：支持各种网络应用
  - FTP、SMTP、HTTP
- 传输层：进程-进程的数据传输
  - TCP，UDP
- 网络层：源主机到目的主机的数据分组路由与转发
  - IP协议、路由协议等
- 链路层：相邻网络元素（主机、交换机、路由器等）的数据传输
  - 以太网（Ethernet）、802.11（wifi）、PPP
- 物理层：比特传输

> 5层参考模型中的交换机&路由器
>
> - 交换机：只含数据链路层和物理层
>
> - 路由器：含网络层、数据链路层、物理层

> 5层参考模型中的数据封装
>
> - 应用层：+ 报文
> - 传输层：+ 段
> - 网络层：+ 数据报
> - 链路层：+ 帧

