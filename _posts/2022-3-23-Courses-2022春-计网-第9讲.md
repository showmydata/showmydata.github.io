---
layout: post
title: "2022春-计网-第9讲"
categories: 
  - Courses
tags:
  - 课程学习
  - 计算机网络
last_modified_at: 2022-03-23T22:10:52+08:00u
---

**以太网交换机**

- 链路层设备
  - 存储-转发以太网帧
  - 检验到达帧的目的MAC地址，选择性向一个或多个输出链路转发帧
  - 利用CSMA/CD访问链路，发送帧
- 透明
  - 主机感知不到交换机的存在
- 即插即用
- 自学习
  - 交换机无需配置
- 直通传输
  - 只检查6B的源MAC地址
- 多端口间同时传输
  - 主机利用共享链路直接连接交换机
  - 交换机缓存帧
  - 交换机在每段链路上利用CSMA/CD收发帧，但无冲突，且可以全双工
- 交换表
  - 每个交换机有一个交换表
  - 每个入口（主机的MAC地址，到达主机的接口，时间戳），看起来很像路由表
  - 通过自学习获知到达主机的接口信息
  - 帧过滤/转发
    - 如果找到匹配的入口，则单个入口转发，否则泛洪转发

**广播域&冲突域**

- 二层广播域：交换机、网桥
- 一层冲突域：集线器

**VLANs**

- 虚拟局域网：支持VLAN划分的交换机，可以在一个物理LAN架构上配置、定义多个VLAN
- 基于端口的VLAN：
  - 流量隔离
  - 动态成员
  - 在VLAN间转发：通过路由（就像在独立的交换机之间）
  - 多线缆连接
  - 中继端口：在跨越多个物理交换机定义的VLAN承载帧
    - 为多VLAN转发802.1帧容易产生歧义
    - 必须携带VLAN的ID信息
    - 802.1q协议为经过中继端口转发的帧增加/去除额外的首部域
      - 插入4字节的VLAN标记
      - 2字节的标记协议标识符，2字节的标记控制信息（3bit的优先级，1bit的CFI，12bit的VLAN ID）
      - 带VLAN标记的帧称为标记帧
      - 普通以太网帧称为无标记帧
- 基于MAC地址的VLAN
- 基于协议的VLAN
- 基于子网的VLAN

---

### PPP 协议

##### 点对点数据链路控制

- 无需介质访问控制，无需明确的MAC寻址
- 常见的点对点数据链路控制协议：
  - HDLC
  - PPP
    - PPP协议是目前使用最多的数据链路层协议之一
    - 能够在不同的链路上运行
    - 能够承载不同的网络层分组
    - 特点：简单、灵活

##### PPP设计需求

- 组帧
  - 同时承载任何网络层协议分组
  - 向上层实现分用（多路分解）
- 比特透明传输
  - 数据域必须支持承载任何比特模式
  - 异步传输时：字节填充
  - 同步传输时：零比特填充
- 差错检测（只检测不需纠正）
- 连接活性检测
  - 检测、并向网络层通知链路状态
- 网络层地址协商
  - 端结点可以学习/配置彼此网络地址

##### PPP协议无需支持的功能

- 无需差错纠正/恢复
- 无需流量控制
- 不存在乱序交付
- 无需支持多点链路

- 差错恢复、流量控制等由高层协议处理

##### PPP数据帧

- 标志：定界符
- 地址：无效
- 控制：无效
- 协议：上层协议
- 信息：上层协议分组数据
- 校验：CRC校验，用于差错检测

##### PPP协议的透明传输

- 数据域必须包含标志模式0x7E
  - 如何判断其是数据or标志
- 异步传输时：字节填充
  - 转义字符：0x7D
  - 将信息字段中出现的0x7E转变为(0x7D，0x5E)
  - 若信息字段中出现0x7D字节，则将其转变为(0x7D，0x5D)
  - 若信息字段中出现ASCII码的控制字符（即数值小于0x20的字符），则在其前面加入0x7D字节
- 同步传输时：零比特填充
  - 信息字段中出现了0x7E
  - 发送端在5个连1之后填入0比特再发送出去
  - 再接收端把5个连1之后的0比特删除

##### PPP数据控制协议

- 配置PPP链路
  - 最大帧长
  - 身份认证
- 学习/配置网络层信息
  - 对于IP协议，通过交换IPCP协议报文，完成IP地址等相关信息配置

##### PPPOE概述

- Ethernet优点
  - 原理简单、应用非常广、设备成本低
- Ethernet缺点
  - 安全性较低、不宜管理
  - 使用广播信道，安全性较低，无认证功能
- PPP优点
  - 原理简单
  - 安全性高：点对点信道，提供认证机制
  - 提供良好的访问控制和计费功能

- PPPoE
  - 提供在以太网链路上的PPP连接
  - 实现了传统以太网不能提供的身份认证、加密以及压缩等功能
  - 实现基于用户的访问控制、计费、业务类型分类等，运营商广泛支持
  - PPPoE使用Client/Server模型，服务器通常是接入服务器

##### PPPoE组网方式

- 组网方式1
  - 一个机构公用一个账号
  - PPPoE Client位于机构内
  - PPPoE Server是运营商的设备

- 组网方式2
  - 每个主机都是PPPoE Client
  - 每个主机有一个账号，方便运营商对用户进行计费和控制

##### PPPoE工作过程

- Discovery阶段
  - 获取对方以太网地址，确定PPPoE会话ID
- Session阶段
  - PPP协商阶段
  - PPP报文数据传输
- Terminate阶段
  - 会话建立以后的任意时刻，发送报文结束会话

##### 链路虚拟化

- 两层寻址
- 在两个不同的网络之间加一层虚拟层，使之可以交换信息
- ATM：异步传输模式
- MPLS：多协议标签交换模式
