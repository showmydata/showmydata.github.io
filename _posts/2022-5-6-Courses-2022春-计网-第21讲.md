---
layout: post
title: "2022春-计网-第21讲"
categories: 
  - Courses
tags:
  - 课程学习
  - 计算机网络
last_modified_at: 2022-05-06T21:10:52+08:00u
---

#### HTTP/3

- QUIC：在UDP之上实现应用，将传输层功能移到应用层
  - Quick UDP Internet Connections


- 应用层实现连接建立、错误控制、拥塞控制等功能
  - 连接建立：可靠性、拥塞控制、身份验证、加密、在1个RTT建立状态
  - 差错控制和拥塞控制：类似于TCP的算法
- 多个应用级"流"复用一个QUIC连接
  - 可靠数据传输与安全分离
- Quic流：并行性、无HOL阻塞

#### HTTP响应时间优化-Web缓存/代理服务器

- 目标：在不访问源服务器的前提下满足客户端的HTTP请求
- 为什么要发明这种技术
  - 缩短客户请求的响应时间：缓存更靠近客户端
  - 减少机构/组织的流量
  - 在大范围内实现有效的内容分发
- 过程
  - 用户设定浏览器通过缓存进行Web访问
  - 浏览器向缓存/代理服务器发送所有的HTTP请求
    - 如果所请求对象在缓存中，缓存返回对象
    - 否则缓存服务器向原始服务器发送HTTP请求，获取对象，然后返回给客户端并保存该对象
- 缓存既充当客户端，也充当服务器
- 一般由ISP架设

- 服务器告诉缓存有关响应标头对象允许的缓存：
  - Cache-Control：max-age=<seconds>
  - Cache-Control：no-cache

#### 条件性GET方法

- Web应用响应时间
- 目标：如果缓存有最新的版本，则不需要发送请求对象
- 缓存：在HTTP请求消息中声明所持有版本的日期

- 服务器：如果缓存的版本是最新的，则响应消息中不包含对象

#### Cookie

- 某些网站为了辨别用户身份、进行session跟踪而储存在用户本地终端上的数据（通常经过加密）
- Cookie的组件
  - HTTP响应消息的cookie头部行
  - HTTP请求消息的cookie头部行
  - 保存在客户端主机上的cookie文件，由浏览器管理
  - Web服务器端的后台数据库
- 隐私问题

### P2P应用

#### 纯P2P架构

- Peer-to-peer
- 没有服务器
- 任意端系统之间直接通信
- 节点阶段性接入Internet
- 节点可能更改IP地址

#### 文件分发：客户机/服务器 vs P2P

- 服务器上传速率$u_s$，客户端上传速率$u_i$，客户端下载速率$d_i$
- C/S架构
  - 服务器串行地发送N个副本$NF/u_s$
  - 每个客户机必须下载1个文件副本
    - 客户i下载1个副本文件：$F/d_i$
    - 下行带宽最小的客户下载1个副本时间：$F/d_{min}$
  - 分发时间$D_{CS}\ge max\{NF/u_s,F/d_{min}\}$

- 文件分发
  - 服务器必须至少上传1个副本$F/u_s$
  - 每个客户端必须下载1个文件副本
    - 客户i下载1个文件副本时间：$F/d_i$
    - 下行带宽最小的客户下载1个副本时间：$F/d_{min}$
    - 服务器于客户共同上传NF比特数据时间：$NF/(u_s+\Sigma u_i)$
  - 分发时间$D_{P2P}\ge max\{F/u_s,\;F/d_{min},\;NF/(u_s+\Sigma u_i)\}$

#### 文件分发：BitTorrent

- tracker：跟踪参与torrent的节点
- torrent：交换同一个文件的文件块的节点组
- 文件划分为256KB的chunk
- 节点加入torrent
  - 没有chunk，但是会逐渐积累
  - 向tracker注册以获得节点清单，与某些节点（“邻居”）建立连接
- 下载的同时，节点需要向其它节点上传chunk
- 节点可能加入或离开
- 一旦节点获得完整的文件，它可能离开或留下
- 获取chunk
  - 给定任一时刻，不同的节点持有文件的不同chunk集合
  - 节点定期查询每个邻居所持有的chunk列表
  - 节点发送请求，请求获取确实的chunk
    - 稀缺优先
- 发送chunk：tit-for-tat
  - 节点向4个邻居发送chunk：正在向起发送Chunk，速率最快的4个
    - 每10s重新评估top4
  - 每30s随机选择一个其它节点，向其发送chunk
    - 新选择节点可能加入top4

#### P2P：搜索信息

- P2P系统的索引：信息到节点为止（IP地址+端口号）的映射
- 文件共享（电路）
  - 利用索引动态跟踪节点所共享的文件的位置
  - 节点需要告诉索引它拥有哪些文件
  - 节点搜索索引，从而获知能够得到哪些文件
- 即时消息（QQ）
  - 索引负责将用户名映射到位置
  - 当用户开启IM应用时，需要通知索引它的位置
  - 节点检索索引，确定用户的IP地址

#### 集中式索引

- 节点加入时，通知中央服务器
  - IP地址
  - 内容
- 节点查找文件
- 节点从对应节点处请求文件

- 集中式索引的问题
  - 内容和文件传输是分布式的，但是内容定位是高度集中式的
  - 单点失效问题
  - 性能瓶颈
  - 版权问题

#### 泛洪式查询

- 完全分布式架构
- 每个节点对它共享的文件进行索引，且只对它共享的文件进行索引
- 覆盖网络
  - 节点x与节点y如果有TCP连接，那么构成一个边
  - 所有的活动节点和边构成覆盖网络
  - 边：虚拟链路
  - 节点一般邻居数少于10个
- 查询消息通过已有的TCP连接发送
- 节点转发查询消息
- 如果查询命中，则利用反向路径发回查询节点

















